<!DOCTYPE html>


<html lang="en-us" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>A new DNS standard? - Pending Supervision</title>

<meta name="description" content="This article is a continuation of my previous one, if you want to know a brief history of DNS I recommend checking it out.
DNS over QUIC (DoQ)     This is a new fresh standard of DNS so fresh that in the time I’m writing this the RFC is still in draft.
DoQ is the same thing as DoT but the transport protocol is QUIC not TCP and you get all the performance benefits from it, that is all there is to it (that was quick).">





<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="apple-touch-icon-precomposed" href="favicon.png">


<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>

<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>



    





    
    
        
    
    

    
        <link rel="stylesheet" href="/css/style.min.82e1632505b3c2656f87b929f00e503634513649b276db300374039f6392cca8.css" integrity="sha256-guFjJQWzwmVvh7kp8A5QNjRRNkmydtswA3QDn2OSzKg=">
    





    

    





    
    
        
    
    

    
        <script src="/js/script.min.510c781c39dbb21b4c76d85c82e2bdf4689220adbb7cd61e49e9d293e442fb42.js" type="text/javascript" charset="utf-8" integrity="sha256-UQx4HDnbshtMdthcguK99GiSIK27fNYeSenSk&#43;RC&#43;0I="></script>
    







<meta property="og:title" content="A new DNS standard?" />
<meta property="og:description" content="This article is a continuation of my previous one, if you want to know a brief history of DNS I recommend checking it out.
DNS over QUIC (DoQ)     This is a new fresh standard of DNS so fresh that in the time I’m writing this the RFC is still in draft.
DoQ is the same thing as DoT but the transport protocol is QUIC not TCP and you get all the performance benefits from it, that is all there is to it (that was quick)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a-new-dns-standard/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-04-28T00:00:00+00:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A new DNS standard?"/>
<meta name="twitter:description" content="This article is a continuation of my previous one, if you want to know a brief history of DNS I recommend checking it out.
DNS over QUIC (DoQ)     This is a new fresh standard of DNS so fresh that in the time I’m writing this the RFC is still in draft.
DoQ is the same thing as DoT but the transport protocol is QUIC not TCP and you get all the performance benefits from it, that is all there is to it (that was quick)."/>











    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <div class="header-top">
    <h1 class="site-title">
    <a href="/">Pending Supervision</a>
</h1>
    <ul class="social-icons">




    <li>
            <a href="/index.xml" title="RSS" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg>

</span>

            </a>
        </li>
    

</ul>
</div>

    <nav></nav>






            
        </header>
        <main id="main" tabindex="-1"> 
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                <h1 class="p-name post-title">A new DNS standard?</h1>

                
            </header>
        </div>
        <div class="content e-content">
            <p>This article is a continuation of my <a href="https://pendsv.substack.com/p/the-evolution-dns?utm_source=substack&amp;utm_campaign=post_embed&amp;utm_medium=web">previous one</a>, if you want to know a brief history of DNS I recommend checking it out.</p>
<h2 id="dns-over-quic-doq" >DNS over QUIC (DoQ)
<span>
    <a href="#dns-over-quic-doq">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>This is a new fresh standard of DNS so fresh that in the time I’m writing this the <a href="https://datatracker.ietf.org/doc/rfc9250/">RFC</a> is still in draft.</p>
<p>DoQ is the same thing as DoT but the transport protocol is QUIC not TCP and you get all the performance benefits from it, that is all there is to it (that was quick). If you are not familiar with QUIC protocol you can continue reading, this is going to be the rest of the article.</p>
<blockquote>
<p>Some DNS providers that support DoQ: <a href="https://adguard.com/en/welcome.html">Adguard</a>, <a href="https://my.nextdns.io/">NextDNS</a>.</p>
</blockquote>
<h2 id="quic-quick-udp-internet-connections" >QUIC (Quick UDP Internet Connections)
<span>
    <a href="#quic-quick-udp-internet-connections">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>This new protocol was invented by Jim Roskind a Google engeener and it has been used in Google projects few years before it has been added to the new HTTP/3 standard. It is a replacement for TCP but design in a way to fit better the modern technologies.</p>
<p>The main difference with TCP is that in QUIC encryption is embedded in the protocol. Compared to TCP first you need to create a connection and have a TCP handshake and then establish a TLS handshake but in QUIC establishing the connection and sharing the public keys between the parties are in the same transaction.</p>
<p><img src="/img/tcp_vs_quic.webp" alt=""></p>
<p>Also in QUIC lost connection can be reestablished with little to no overhead. For example if you switch from mobile data to WiFi on your phone with TCP all the connection need to be reestablished, with QUIC both the server and the client have each others public certificates so the server just needs to know the client new IP address. This is called 0-RTT and may have security risks in some applications but not in DNS.</p>
<p>QUIC has more benefits related to the new HTTP/3 standard but for the scope of this DoQ there is not much left. If you want to learn more about QUIC and HTTP/3 you can check the references.</p>
<h2 id="doh-with-quic" >DoH with QUIC
<span>
    <a href="#doh-with-quic">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>The beauty of the network protocol stack is that you can use DoH with QUIC, without needing a new standard for it, just use it over HTTP/3 since QUIC is the base of HTTP/3. As you may already know DoH is passing dns query over https the main benefit of that is that https is using the port 443 witch is almost never block by the sysadmins.</p>
<h3 id="references" >References:
<span>
    <a href="#references">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p><a href="https://en.wikipedia.org/wiki/QUIC">https://en.wikipedia.org/wiki/QUIC</a><br>
<a href="https://datatracker.ietf.org/doc/rfc9250/">https://datatracker.ietf.org/doc/rfc9250/</a><br>
<a href="https://blog.cloudflare.com/the-road-to-quic/">https://blog.cloudflare.com/the-road-to-quic/</a></p>

        </div>
        

    


<div class="post-info">
    
        <div class="post-date dt-published">2022-04-28</div>
    

    <a class="post-hidden-url u-url" href="/posts/a-new-dns-standard/">/posts/a-new-dns-standard/</a>
    <a href="" class="p-name p-author post-hidden-author h-card" rel="me">Pendsv</a>


    <div class="post-taxonomies">
        
            
                <ul class="post-tags">
                    
                        
                        <li><a href="/tags/networking/">#networking</a></li>
                    
                        
                        <li><a href="/tags/domain/">#domain</a></li>
                    
                        
                        <li><a href="/tags/dns/">#dns</a></li>
                    
                        
                        <li><a href="/tags/dot/">#dot</a></li>
                    
                        
                        <li><a href="/tags/doq/">#doq</a></li>
                    
                        
                        <li><a href="/tags/quic/">#quic</a></li>
                    
                </ul>
        
    </div>
</div>

    </article>

    
        
        
            <h3 class="read-next-title">Read next</h3>
            <ul class="read-next-posts">
                
                <li><a href="/posts/the-evolution-dns/">The Evolution DNS</a></li>
                
            </ul>
        
    

    
        
    <div class="pagination post-pagination">
        <div class="left pagination-item disabled">
            
        </div>
        <div class="right pagination-item ">
            
                <a href="/posts/the-evolution-dns/">The Evolution DNS</a>
            
        </div>
    </div>




    

    
        


    


<script src="https://utteranc.es/client.js"
        repo="vlabo/website"
        theme="github-light"
        label="utteranc-es"
        issue-term="url"
        crossorigin="anonymous"
        async>
</script>






    

        </main>
        
            <footer class="common-footer">
    
    

    <div class="common-footer-bottom">
        
        <div class="copyright">
            <p>© Pendsv, 2022<br>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.<br>
            
            </p>  
        </div> 

        

    




<script>
const STORAGE_KEY = 'user-color-scheme'
const defaultTheme = "auto-without-switcher"

let currentTheme
let switchButton
let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

const autoChangeScheme = e => {
    currentTheme = e.matches ? 'dark' : 'light'
    document.documentElement.setAttribute('data-theme', currentTheme)
    changeButtonText()
}

document.addEventListener('DOMContentLoaded', function() {
    switchButton = document.querySelector('.theme-switcher')
    currentTheme = detectCurrentScheme()
    if (currentTheme == 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark')
    }
    if (currentTheme == 'auto') {
        autoChangeScheme(autoDefinedScheme);
        autoDefinedScheme.addListener(autoChangeScheme);
    }

    if (switchButton) {
        changeButtonText()
        switchButton.addEventListener('click', switchTheme, false)
    }
  
    showContent()
})

function detectCurrentScheme() {
    if (localStorage.getItem(STORAGE_KEY)) {
        return localStorage.getItem(STORAGE_KEY)
    } 
    if (defaultTheme) {
        return defaultTheme
    } 
    if (!window.matchMedia) {
        return 'light'
    } 
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        return 'dark'
    }
    return 'light'
}

function changeButtonText()
{   
    if (switchButton) {
        switchButton.textContent = currentTheme == 'dark' ?  "Light theme" : "Dark theme"
    }
}

function switchTheme(e) {
    if (currentTheme == 'dark') {
        localStorage.setItem(STORAGE_KEY, 'light')
        document.documentElement.setAttribute('data-theme', 'light')
        currentTheme = 'light'
    } else {
        localStorage.setItem(STORAGE_KEY, 'dark')
        document.documentElement.setAttribute('data-theme', 'dark')
        currentTheme = 'dark'
    }
    changeButtonText()
}

function showContent() {
    document.body.style.visibility = 'visible';
    document.body.style.opacity = 1;
}
</script>   
    </div>

    <p class="h-card vcard">

    <a href= class="p-name u-url url fn" rel="me">Pendsv</a> 

     
        /
        <a class="p-email u-email email" rel="me" href="mailto:blog@pendsv.com">blog@pendsv.com</a>
    

    
</p> 
</footer>

        
    </div>
</body>
</html>
